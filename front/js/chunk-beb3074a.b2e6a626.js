(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-beb3074a"],{"482e":function(t,e,i){},aaca:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:t.title,"close-on-click-modal":!1,visible:t.visible},on:{"update:visible":function(e){t.visible=e}}},[i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"inputForm",class:"view"===t.method?"readonly":"",attrs:{model:t.inputForm,size:"small",disabled:"view"===t.method,"label-width":"120px"}},[i("el-row",{attrs:{gutter:15}},[i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"模板名称",prop:"templateName",rules:[]}},[i("el-input",{attrs:{placeholder:"请填写模板名称"},model:{value:t.inputForm.templateName,callback:function(e){t.$set(t.inputForm,"templateName",e)},expression:"inputForm.templateName"}})],1)],1),i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"模板json",prop:"template",rules:[]}},[i("vue-json-editor",{ref:"templateEditor",staticStyle:{height:"calc(30%)"},attrs:{showBtns:!1,mode:"code"},on:{"json-change":t.onJsonChange,"has-error":t.onError},model:{value:t.inputForm.template,callback:function(e){t.$set(t.inputForm,"template",e)},expression:"inputForm.template"}})],1)],1),i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"模板变量名中文名",prop:"nameDict",rules:[]}},[i("vue-json-editor",{ref:"nameDictEditor",staticStyle:{height:"calc(30%)"},attrs:{showBtns:!1,mode:"code"},on:{"json-change":t.onJsonChange,"has-error":t.onError},model:{value:t.inputForm.nameDict,callback:function(e){t.$set(t.inputForm,"nameDict",e)},expression:"inputForm.nameDict"}})],1)],1)],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(e){t.visible=!1}}},[t._v("关闭")]),"view"!=t.method?i("el-button",{directives:[{name:"noMoreClick",rawName:"v-noMoreClick"}],attrs:{size:"small",type:"primary"},on:{click:function(e){return t.doSubmit()}}},[t._v("确定")]):t._e()],1)],1)],1)},n=[],o=i("bf2d"),s=i("27c2"),r=i("45a3"),l=i("15a0"),m={data:function(){return{title:"",method:"",visible:!1,loading:!1,inputForm:{id:"",templateName:"",template:{},nameDict:{}},hasJsonFlag:!0}},components:{WangEditor:s["a"],vueJsonEditor:r["a"]},mqttTemplateService:null,created:function(){this.mqttTemplateService=new l["a"]},methods:{init:function(t,e){var i=this;this.method=t,this.inputForm.id=e,"add"===t?this.title="新建MqttTemplate":"edit"===t?this.title="修改MqttTemplate":"view"===t&&(this.title="查看MqttTemplate"),this.visible=!0,this.loading=!1,this.$nextTick((function(){i.$refs.inputForm.resetFields(),"edit"!==t&&"view"!==t||(i.loading=!0,i.mqttTemplateService.queryById(i.inputForm.id).then((function(t){var e=t.data;i.inputForm=i.recover(i.inputForm,e),i.inputForm.template=JSON.parse(e.template),i.inputForm.nameDict=JSON.parse(e.nameDict),i.loading=!1})))}))},doSubmit:function(){var t=this,e=this.checkJson();e&&this.$refs["inputForm"].validate((function(e){e&&(t.loading=!0,t.inputForm.template=JSON.stringify(t.inputForm.template),t.inputForm.nameDict=JSON.stringify(t.inputForm.nameDict),t.mqttTemplateService.save(t.inputForm).then((function(e){var i=e.data;t.visible=!1,t.$message.success(i),t.$emit("refreshDataList"),t.loading=!1})).catch((function(){t.loading=!1})))}))},onJsonChange:function(t){this.hasJsonFlag=this.isJson(JSON.stringify(t))},onError:function(t){this.hasJsonFlag=!1},checkJson:function(){return console.log(this.TemplatehasJsonFlag),console.log(this.NameDicthasJsonFlag),!1===this.TemplatehasJsonFlag||!1===this.NameDicthasJsonFlag?(alert("json验证失败"),!1):(alert("json验证成功"),!0)},isJson:function(t){if("string"==typeof t)try{var e=JSON.parse(t);return!("object"!=Object(o["a"])(e)||!e)}catch(i){return console.log("json格式错误"),!1}}}},c=m,u=(i("bd49"),i("2877")),p=Object(u["a"])(c,a,n,!1,null,"90f4f43e",null);e["default"]=p.exports},bd49:function(t,e,i){"use strict";var a=i("482e"),n=i.n(a);n.a}}]);