(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-09e8e0a1","chunk-78e746f4"],{"54d8":function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:e.title,"append-to-body":!0,"close-on-click-modal":!1,visible:e.visible},on:{"update:visible":function(t){e.visible=t}}},[i("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"inputForm",class:"view"===e.method?"readonly":"",attrs:{size:"small",model:e.inputForm,disabled:"view"===e.method,"label-width":"120px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doSubmit()},submit:function(e){e.preventDefault()}}},[i("el-form-item",{attrs:{label:"数据规则名称",prop:"name"}},[i("el-input",{attrs:{placeholder:"数据规则名称"},model:{value:e.inputForm.name,callback:function(t){e.$set(e.inputForm,"name",t)},expression:"inputForm.name"}})],1),i("el-form-item",{attrs:{label:"规则mapper方法",prop:"className"}},[i("el-input",{attrs:{placeholder:"规则mapper方法"},model:{value:e.inputForm.className,callback:function(t){e.$set(e.inputForm,"className",t)},expression:"inputForm.className"}}),i("div",{staticClass:"help-block"},[e._v("请输入要进行数据权限过滤的的mapper方法（例如: com.jeeplus.xxx.xxMapper.findList)。")])],1),i("el-form-item",{attrs:{label:"规则字段",prop:"field"}},[i("el-input",{attrs:{placeholder:"规则字段"},model:{value:e.inputForm.field,callback:function(t){e.$set(e.inputForm,"field",t)},expression:"inputForm.field"}})],1),i("el-form-item",{attrs:{label:"规则条件",prop:"express"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"规则条件"},model:{value:e.inputForm.express,callback:function(t){e.$set(e.inputForm,"express",t)},expression:"inputForm.express"}},e._l(e.$dictUtils.getDictList("t_express"),(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"规则值",prop:"value"}},[i("el-autocomplete",{staticStyle:{width:"100%"},attrs:{clearable:"","fetch-suggestions":e.querySearch,placeholder:"请输入规则值"},model:{value:e.inputForm.value,callback:function(t){e.$set(e.inputForm,"value",t)},expression:"inputForm.value"}})],1),i("el-form-item",{attrs:{label:"自定义sql",prop:"sqlSegment"}},[i("el-input",{attrs:{type:"textarea",rows:2,placeholder:"备注"},model:{value:e.inputForm.sqlSegment,callback:function(t){e.$set(e.inputForm,"sqlSegment",t)},expression:"inputForm.sqlSegment"}})],1),i("el-form-item",{attrs:{label:"备注",prop:"remarks"}},[i("el-input",{attrs:{type:"textarea",rows:2,placeholder:"备注"},model:{value:e.inputForm.remarks,callback:function(t){e.$set(e.inputForm,"remarks",t)},expression:"inputForm.remarks"}})],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small",icon:"el-icon-circle-close"},on:{click:function(t){e.visible=!1}}},[e._v("关闭")]),"view"!=e.method?i("el-button",{directives:[{name:"noMoreClick",rawName:"v-noMoreClick"}],attrs:{size:"small",type:"primary",icon:"el-icon-circle-check"},on:{click:function(t){return e.doSubmit()}}},[e._v("确定")]):e._e()],1)],1)},a=[],n=i("b808"),l={data:function(){return{visible:!1,loading:!1,method:"",title:"",inputForm:{id:"",menuId:"",name:"",className:"",field:"",express:"",value:"",sqlSegment:"",remarks:""}}},methods:{init:function(e,t){var i=this;this.method=e,this.inputForm.id=t.id,this.inputForm.menuId=t.menuId,"add"===e?this.title="新增数据规则":"edit"===e?this.title="修改数据规则":"view"===e&&(this.title="查看数据规则"),this.visible=!0,this.$nextTick((function(){i.$refs["inputForm"].resetFields(),"edit"!==e&&"view"!==e||n["a"].queryById(i.inputForm.id).then((function(e){var t=e.data;i.inputForm=i.recover(i.inputForm,t)}))}))},querySearch:function(e,t){var i=[{title:"当前登录用户姓名",value:"@currentUser.name"},{title:"当前登录用户id",value:"@currentUser.id"},{title:"当前登录用户登录名",value:"@currentUser.loginName"},{title:"当前登录用户工号",value:"@currentUser.no"},{title:"当前登录用户所属公司",value:"@currentUser.companyDTO.name"},{title:"当前登录用户所属公司id",value:"@currentUser.companyDTO.id"},{title:"当前登录用户所属部门",value:"@currentUser.officeDTO.name"},{title:"当前登录用户所属部门id",value:"@currentUser.officeDTO.id"}];t(i)},doSubmit:function(){var e=this;this.$refs["inputForm"].validate((function(t){t&&(e.loading=!0,n["a"].save(e.inputForm).then((function(t){var i=t.data;e.loading=!1,e.$message({message:i,type:"success",duration:1500}),e.visible=!1,e.$emit("refreshDataList",e.inputForm.menuId)})).catch((function(){e.loading=!1})))}))}}},s=l,o=i("2877"),u=Object(o["a"])(s,r,a,!1,null,null,null);t["default"]=u.exports},5935:function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"page"},[i("div",{staticClass:"bg-white top"},[i("vxe-toolbar",{attrs:{refresh:{query:e.refreshList},custom:""},scopedSlots:e._u([{key:"buttons",fn:function(){return[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.add()}}},[e._v("新建")])]},proxy:!0}])}),i("div",{staticStyle:{height:"calc(100% - 100px)"}},[i("vxe-table",{ref:"roleTable",attrs:{border:"inner","auto-resize":"",resizable:"",height:"auto",loading:e.loading,size:"small","show-header-overflow":"","show-overflow":"","highlight-hover-row":"","menu-config":{},"print-config":{},"import-config":{},"export-config":{},"sort-config":{remote:!1},data:e.dataList,"checkbox-config":{}}},[i("vxe-column",{attrs:{type:"seq",width:"40"}}),i("vxe-column",{attrs:{width:"160px",title:"数据规则名称",field:"name",sortable:""}}),i("vxe-column",{attrs:{width:"160px",title:"规则mapper方法",field:"className",sortable:""}}),i("vxe-column",{attrs:{width:"160px",title:"规则字段",field:"field",sortable:""}}),i("vxe-column",{attrs:{width:"160px",title:"规则条件",field:"express",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.$dictUtils.getDictLabel("t_express",t.row.express,""))+" ")]}}])}),i("vxe-column",{attrs:{width:"160px",title:"规则值",field:"value",sortable:""}}),i("vxe-column",{attrs:{width:"160px",title:"自定义SQL",field:"sqlSegment",sortable:""}}),i("vxe-column",{attrs:{width:"160px",title:"备注信息",field:"remarks",sortable:""}}),i("vxe-column",{attrs:{width:"160px",title:"规则值",field:"value",sortable:""}}),i("vxe-column",{attrs:{title:"操作",width:"160px",fixed:"right",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini"},on:{click:function(i){return e.edit(t.row.id)}}},[e._v("修改")]),i("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(i){return e.del(t.row.id)}}},[e._v(" 删除 ")])]}}])})],1)],1),i("data-rule-form",{ref:"dataRuleForm",on:{refreshDataList:e.refreshList}})],1)])},a=[],n=i("54d8"),l=i("b808"),s={data:function(){return{dataList:[],loading:!1,menuId:"",title:""}},props:["dataRuleTitle"],components:{DataRuleForm:n["default"]},activated:function(){this.refreshList(this.menuId)},methods:{refreshList:function(e){var t=this;e&&(this.menuId=e),this.loading=!0,l["a"].list({current:1,size:-1,menuId:this.menuId}).then((function(e){var i=e.data;t.dataList=i.records,t.loading=!1}))},add:function(){this.$refs.dataRuleForm.init("add",{id:"",menuId:this.menuId})},edit:function(e){this.$refs.dataRuleForm.init("edit",{id:e,menuId:this.menuId})},view:function(e){this.$refs.dataRuleForm.init("view",{id:e,menuId:this.menuId})},sortChangeHandle:function(e){this.tablePage.orders=[],this.tablePage.orders.push({column:this.$utils.toLine(e.property),asc:"asc"===e.order}),this.refreshList()},del:function(e){var t=this;this.$confirm("确定删除该条记录吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,l["a"].delete(e).then((function(e){var i=e.data;t.loading=!1,t.$message.success(i),t.refreshList(t.menuId)}))}))}}},o=s,u=i("2877"),c=Object(u["a"])(o,r,a,!1,null,null,null);t["default"]=c.exports},b808:function(e,t,i){"use strict";var r=i("8f4d");t["a"]={save:function(e){return Object(r["a"])({url:"/sys/dataRule/save",method:"post",data:e})},delete:function(e){return Object(r["a"])({url:"/sys/dataRule/delete",method:"delete",params:{id:e}})},queryById:function(e){return Object(r["a"])({url:"/sys/dataRule/queryById",method:"get",params:{id:e}})},list:function(e){return Object(r["a"])({url:"/sys/dataRule/list",method:"get",params:e})},treeData:function(){return Object(r["a"])({url:"/sys/dataRule/treeData",method:"get"})}}}}]);