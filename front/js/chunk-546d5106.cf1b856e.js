(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-546d5106","chunk-d9e12920"],{1952:function(e,t,a){"use strict";var l=a("8f4d");t["a"]={save:function(e){return Object(l["a"])({url:"/form/make/save",method:"post",data:e})},saveFormSource:function(e){return Object(l["a"])({url:"/form/make/saveFormSource",method:"post",data:e})},saveBasicInfo:function(e){return Object(l["a"])({url:"/form/make/saveBasicInfo",method:"post",data:e})},delete:function(e){return Object(l["a"])({url:"/form/make/delete",method:"delete",params:{ids:e}})},queryById:function(e){return Object(l["a"])({url:"/form/make/queryById",method:"get",params:{id:e}})},getTableColumnList:function(e){return Object(l["a"])({url:"/form/make/getTableColumnList",method:"get",params:e})},getTableList:function(e){return Object(l["a"])({url:"/form/make/getTableList",method:"get",params:e})},list:function(e){return Object(l["a"])({url:"/form/make/list",method:"get",params:e})},validateTableNoExist:function(e){return Object(l["a"])({url:"/form/make/validateTableNoExist",method:"get",params:e})},validateKeyNoExist:function(e){return Object(l["a"])({url:"/form/make/validateKeyNoExist",method:"get",params:e})},createMenu:function(e){return Object(l["a"])({url:"/form/make/createMenu",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"},data:e})}}},"5b74":function(e,t,a){},"6b47":function(e,t,a){"use strict";var l=a("5b74"),n=a.n(l);n.a},9269:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{padding:"10px"}},[a("el-row",{staticStyle:{"margin-bottom":"10px"}},[a("el-alert",{staticStyle:{"margin-bottom":"10px"},attrs:{title:"如需对动态表单创建数据权限，请添加数据规则。添加后的规则，可在[菜单管理->数据规则]中查看。",type:"success"}}),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.add()}}},[e._v("添加数据规则")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.dataRuleDTOList,size:"small"}},[a("el-table-column",{attrs:{type:"selection","header-align":"center",align:"center",width:"50"}}),a("el-table-column",{attrs:{prop:"name","header-align":"center",align:"center",width:"120px",label:"数据规则名称"}}),a("el-table-column",{attrs:{prop:"className","header-align":"center",align:"center",label:"表名"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"field","header-align":"center",align:"center",label:"规则字段"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"express","header-align":"center",align:"center",label:"规则条件"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.$dictUtils.getDictLabel("t_express",t.row.express,""))+" ")]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"value","header-align":"center",align:"center",label:"规则值"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"sqlSegment","header-align":"center",align:"center",width:"100px",label:"自定义sql"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"remarks","header-align":"center",align:"center",label:"备注信息"}}),a("el-table-column",{key:Math.random(),attrs:{fixed:"right","header-align":"center",align:"center",width:"150",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.edit(t.row)}}},[e._v("修改")]),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.del(t.row)}}},[e._v(" 删除 ")])]}}])})],1),a("data-rule-form",{ref:"dataRuleForm",on:{addRow:function(t){return e.saveDataRuleForm(arguments)}}})],1)},n=[],r=(a("4160"),a("a434"),a("159b"),a("f20b")),i={data:function(){return{dataRuleDTOList:[],loading:!1,rows:[],menuId:"",pageNo:1,pageSize:-1,total:0,title:""}},props:["dataRuleTitle","form"],components:{DataRuleForm:r["default"]},methods:{saveDataRuleForm:function(e){var t=this;""===e[0]?this.dataRuleDTOList.push(e[1]):this.dataRuleDTOList.forEach((function(a,l){a===e[0]&&t.dataRuleDTOList.splice(l,1,e[1])}))},add:function(){this.$refs.dataRuleForm.init("add",{},{menuId:this.menuId,dsName:this.form.dataSource.enName,tableName:this.form.tableName})},edit:function(e){this.$refs.dataRuleForm.init("edit",e,{menuId:this.menuId,dsName:this.form.dataSource.enName,tableName:this.form.tableName})},del:function(e){var t=this;this.$confirm("确定删除该条记录吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.dataRuleDTOList.forEach((function(e,a){t.dataRuleDTOList.splice(a,1)}))}))}}},o=i,s=(a("6b47"),a("2877")),u=Object(s["a"])(o,l,n,!1,null,null,null);t["default"]=u.exports},f20b:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:e.title,"append-to-body":!0,"close-on-click-modal":!1,visible:e.visible},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"inputForm",class:"view"===e.method?"readonly":"",attrs:{size:"small",model:e.inputForm,disabled:"view"===e.method,"label-width":"120px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doSubmit()},submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:"数据规则名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"数据规则名称"},model:{value:e.inputForm.name,callback:function(t){e.$set(e.inputForm,"name",t)},expression:"inputForm.name"}})],1),a("el-form-item",{attrs:{label:"表名",prop:"className"}},[a("el-input",{attrs:{placeholder:"表名"},model:{value:e.inputForm.className,callback:function(t){e.$set(e.inputForm,"className",t)},expression:"inputForm.className"}})],1),a("el-form-item",{attrs:{label:"规则字段",prop:"field"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择表"},model:{value:e.inputForm.field,callback:function(t){e.$set(e.inputForm,"field",t)},expression:"inputForm.field"}},e._l(e.dataTableColumns,(function(e){return a("el-option",{key:e.name,attrs:{label:e.nameAndComments,value:e.name}})})),1)],1),a("el-form-item",{attrs:{label:"规则条件",prop:"express"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"规则条件"},model:{value:e.inputForm.express,callback:function(t){e.$set(e.inputForm,"express",t)},expression:"inputForm.express"}},e._l(e.$dictUtils.getDictList("t_express"),(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"规则值",prop:"value"}},[a("el-input",{attrs:{placeholder:"value"},model:{value:e.inputForm.value,callback:function(t){e.$set(e.inputForm,"value",t)},expression:"inputForm.value"}})],1),a("el-form-item",{attrs:{label:"自定义sql",prop:"sqlSegment"}},[a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"备注"},model:{value:e.inputForm.sqlSegment,callback:function(t){e.$set(e.inputForm,"sqlSegment",t)},expression:"inputForm.sqlSegment"}})],1),a("el-form-item",{attrs:{label:"备注",prop:"remarks"}},[a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"备注"},model:{value:e.inputForm.remarks,callback:function(t){e.$set(e.inputForm,"remarks",t)},expression:"inputForm.remarks"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",icon:"el-icon-circle-close"},on:{click:function(t){e.visible=!1}}},[e._v("关闭")]),"view"!=e.method?a("el-button",{directives:[{name:"noMoreClick",rawName:"v-noMoreClick"}],attrs:{size:"small",type:"primary",icon:"el-icon-circle-check"},on:{click:function(t){return e.doSubmit()}}},[e._v("确定")]):e._e()],1)],1)},n=[],r=a("1952"),i={data:function(){return{visible:!1,loading:!1,method:"",title:"",oldInputForm:"",dataTableColumns:[],inputForm:{id:"",menuId:"",name:"",className:"",field:"",express:"",value:"",sqlSegment:"",remarks:""}}},methods:{init:function(e,t,a){var l=this;this.method=e,this.inputForm.id=a.id,this.inputForm.menuId=a.menuId,this.inputForm.className=a.tableName,"add"===e?this.title="新增数据规则":"edit"===e?this.title="修改数据规则":"view"===e&&(this.title="查看数据规则"),this.visible=!0,this.$nextTick((function(){l.$refs["inputForm"].resetFields(),l.getTableColumnList(a.tableName,a.dsName),l.$nextTick((function(){l.$refs.inputForm.resetFields(),l.inputForm.id="",l.oldInputForm="","edit"!==e&&"view"!==e||(l.oldInputForm=t,l.inputForm=JSON.parse(JSON.stringify(t)))}))}))},getTableColumnList:function(e,t){var a=this;r["a"].getTableColumnList({name:e,"dataSource.enName":t||"master"}).then((function(e){var t=e.data;a.dataTableColumns=t.rows}))},doSubmit:function(){var e=this;this.$refs["inputForm"].validate((function(t){t&&(e.$emit("addRow",e.oldInputForm,JSON.parse(JSON.stringify(e.inputForm))),e.visible=!1)}))}}},o=i,s=a("2877"),u=Object(s["a"])(o,l,n,!1,null,null,null);t["default"]=u.exports}}]);