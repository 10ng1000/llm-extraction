(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6de8a308"],{"478a":function(e,t,n){"use strict";var a=n("b2cc"),i=n.n(a);i.a},"4d63":function(e,t,n){var a=n("83ab"),i=n("da84"),r=n("e330"),o=n("94ca"),s=n("7156"),d=n("9112"),c=n("241c").f,u=n("3a9b"),l=n("44e7"),f=n("577e"),p=n("90d8"),h=n("9f7f"),g=n("aeb0"),m=n("cb2d"),v=n("d039"),y=n("1a2d"),k=n("69f3").enforce,x=n("2626"),b=n("b622"),w=n("fce3"),E=n("107c"),_=b("match"),A=i.RegExp,D=A.prototype,$=i.SyntaxError,F=r(D.exec),M=r("".charAt),I=r("".replace),T=r("".indexOf),C=r("".slice),N=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,S=/a/g,z=/a/g,L=new A(S)!==S,R=h.MISSED_STICKY,P=h.UNSUPPORTED_Y,j=a&&(!L||R||w||E||v((function(){return z[_]=!1,A(S)!=S||A(z)==z||"/a/i"!=A(S,"i")}))),G=function(e){for(var t,n=e.length,a=0,i="",r=!1;a<=n;a++)t=M(e,a),"\\"!==t?r||"."!==t?("["===t?r=!0:"]"===t&&(r=!1),i+=t):i+="[\\s\\S]":i+=t+M(e,++a);return i},B=function(e){for(var t,n=e.length,a=0,i="",r=[],o={},s=!1,d=!1,c=0,u="";a<=n;a++){if(t=M(e,a),"\\"===t)t+=M(e,++a);else if("]"===t)s=!1;else if(!s)switch(!0){case"["===t:s=!0;break;case"("===t:F(N,C(e,a+1))&&(a+=2,d=!0),i+=t,c++;continue;case">"===t&&d:if(""===u||y(o,u))throw new $("Invalid capture group name");o[u]=!0,r[r.length]=[u,c],d=!1,u="";continue}d?u+=t:i+=t}return[i,r]};if(o("RegExp",j)){for(var O=function(e,t){var n,a,i,r,o,c,h=u(D,this),g=l(e),m=void 0===t,v=[],y=e;if(!h&&g&&m&&e.constructor===O)return e;if((g||u(D,e))&&(e=e.source,m&&(t=p(y))),e=void 0===e?"":f(e),t=void 0===t?"":f(t),y=e,w&&"dotAll"in S&&(a=!!t&&T(t,"s")>-1,a&&(t=I(t,/s/g,""))),n=t,R&&"sticky"in S&&(i=!!t&&T(t,"y")>-1,i&&P&&(t=I(t,/y/g,""))),E&&(r=B(e),e=r[0],v=r[1]),o=s(A(e,t),h?this:D,O),(a||i||v.length)&&(c=k(o),a&&(c.dotAll=!0,c.raw=O(G(e),n)),i&&(c.sticky=!0),v.length&&(c.groups=v)),e!==y)try{d(o,"source",""===y?"(?:)":y)}catch(x){}return o},q=c(A),H=0;q.length>H;)g(O,A,q[H++]);D.constructor=O,O.prototype=D,m(i,"RegExp",O,{constructor:!0})}x("RegExp")},ad1e:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{id:"failurepredictdiv",title:e.title,"close-on-press-escape":!1,"close-on-click-modal":!1,visible:e.visible,loading:e.loading},on:{"update:visible":function(t){e.visible=t}}},[n("div",{staticClass:"main",attrs:{id:"graphcontainerdiv"}},[n("div",[e._v(" 生存期："+e._s(e.lifetime_predict)+" ")]),n("div",[e._v(" 预测故障类型："+e._s(e.failure_type)+" ")]),n("div",[e._v(" 详细内容： ")]),n("el-tree",{attrs:{data:e.treenodeinfo,"default-expand-all":"","node-key":"targetid","default-expanded-keys":["0","1000000"]}}),n("div",[e._v(" 知识图谱： ")]),n("div",{staticClass:"graphcontainer",attrs:{id:"graphcontainer"},on:{click:e.graphContainerClick}})],1),n("div",{attrs:{id:"illustration"}},e._l(e.illustrations,(function(t,a){return n("div",{key:a},[n("span",{staticStyle:{cursor:"pointer"},style:{backgroundColor:e.nodeColorMap.get(t)},attrs:{"data-index":a}}),e._v(" "+e._s(t)+" ")])})),0)])},i=[],r=(n("99af"),n("4de4"),n("7db0"),n("4160"),n("c975"),n("fb6a"),n("a434"),n("0d03"),n("b0c0"),n("4ec9"),n("b680"),n("d3b7"),n("acd8"),n("e25e"),n("4d63"),n("ac1f"),n("25f0"),n("3ca3"),n("5319"),n("c7cd"),n("159b"),n("ddb0"),n("96cf"),n("2ef0")),o=n.n(r),s=n("5698"),d=n("eed2"),c={name:"FailurePredictForm",computed:{},watch:{},components:{},data:function(){return{visible:!1,loading:!0,title:"故障预测",tabIdx:"first",svg:null,simulation:null,linkGroup:null,linktextGroup:null,nodeGroup:null,nodetextGroup:null,nodesymbolGroup:null,nodebuttonGroup:null,nodebuttonAction:"",tooltip:null,txx:{},tyy:{},nodedetail:null,nodedetailCN:new Object({"头节点":"","名称":"","尾节点":"","节点类型":"","页数":""}),nodeinfo:new Map,nodedetailCnList:new Map([["sourcename","头节点"],["name","名称"],["targetname","尾节点"],["fileID",""],["uuid",""],["type","节点类型"],["page_num","页数"]]),pagesizelist:[{size:100,isactive:!0},{size:500,isactive:!1},{size:1e3,isactive:!1},{size:2e3,isactive:!1}],hopssizelist:[{size:1,isactive:!0},{size:2,isactive:!1},{size:3,isactive:!1},{size:4,isactive:!1},{size:5,isactive:!1}],predefineColors:["#ff4500","#ff8c00","#90ee90","#00ced1","#1e90ff","#c71585"],nodeColorMap:new Map([["值","#19CAAD"],["原因","#8CC7B5"],["属性","#D1BA74"],["操作","#A0EEE1"],["故障","#F28500"],["机组","#3F69A3"],["组件","#8D7DC9"],["部件","#C6F716"],["参数","#BEEDC7"],["定义","#BEE7E9"],["定义内容","#D6D5B7"],["操作","#E6CEAC"],["标准/规范","#ECAD9E"],["步骤","#F4606C"],["注意","#F6FF75"],["特性","#E1A1FF"],["章节名","#FFECA1"],["要求","#FC6A6A"]]),dataconfigactive:"",isedit:!1,isaddnode:!1,isaddlink:!1,isdeletelink:!1,isbatchcreate:!1,iscreategraph:!1,selectnodeid:0,selectnodename:"",selectsourcenodeid:0,selecttargetnodeid:0,domain:"",domainid:0,domainnodename:"",nodename:"",pagesize:100,cyphertext:"",cyphertextshow:!1,jsonshow:!1,propactiveName:"propedit",properties:{},propertyCreate:!1,selectnode:{name:"",count:0},pageModel:{pageIndex:1,pageSize:10,totalCount:0,totalPage:0,nodeList:[]},graph:{nodes:[],links:[]},graphEntity:{fileID:"",uuid:0,name:"",color:"ff4500",r:40,x:"",y:""},createGraphEntity:{graphname:"",domaintype:"",nodename:"",fileID:""},currentDomain:"无",currentFile:{file:!0,id:"",leaf:!0,name:"",pdf:""},pageNum:1,pageTotalNum:1,scale:100,idx:-1,pdfUrl:"",pdfUrls:new Map([["1","制冷与低温技术原理.pdf"],["2","降膜机组使用说明书v5.0.pdf"],["3","降膜机组调试要点说明书v5.0.pdf"],["4","离心式／螺杆式制冷机组及应用.pdf"],["5","制冷与空调装置.pdf"]]),lifetime_map:new Map([["0","故障已发生"],["1","预计还能正常运行1天"],["2","预计还能正常运行1-5天"],["3","预计还能正常运行5-10天"],["4","预计还能正常运行10-15天"],["5","预计还能正常运行15-20天"],["6","预计还能正常运行20-25天"],["7","预计还能正常运行25-30天"],["8","预计还能正常运行30天以上"]]),Recommend:[],hops:1,activeNames:["名称","节点类型","组成","包含","原理为","原因","特性为","定义为","步骤为","处理方式","符合","参数为","同义词","故障"],illustrations:[],lifetime_predict:"",failure_type:[],tempalte_id:"",initialize:!0,treenodeinfo:null}},filters:{labelformat:function(e){var t=e.substring(1,e.length-1);return t}},mounted:function(){},created:function(){this.failurePredictService=new d["a"]},methods:{init:function(e,t){var n=this;n.tempalte_id=t,n.visible=!0;var a=this.$loading({target:"#failurepredictdiv"});this.failurePredictService.predict(e).then((function(e){var t=e.data;n.lifetime_predict=n.lifetime_map.get(t["lifetime_predict"].toString())?n.lifetime_map.get(t["lifetime_predict"].toString()):"未知"})),this.failurePredictService.type(e).then((function(e){var t=e.data;n.failure_type=t["failureType_predict"],n.$api.kgManager.getFailurePredictDomainGraph({failure_type:n.failure_type,tempalte_id:n.tempalte_id}).then((function(e){if(200===e.code){var t=e.data;null!=t&&(n.graph.nodes=t.node,n.graph.links=t.relationship,n.initialize&&(n.initgraph(),n.initialize=!1),n.updategraph(),n.setNodeInfo())}})).catch((function(e){n.$message.error("没有相关知识，请参考相关推荐")})).finally((function(){a.close()}))}))},setNodeInfo:function(){var e=this.graph.links;this.graph.nodes.forEach((function(t){"机组"===t["type"]&&e.push({uuid:t["uuid"],sourceid:null,targetid:t["uuid"],name:null,sourcename:null,targetname:t["name"]})})),this.treenodeinfo=this.toTree(e)},toTree:function(e){var t=[],n=new RegExp('"',"g");if(!Array.isArray(e))return t;e.forEach((function(e){!e["label"]&&e["targetname"]&&(e["name"]?e["label"]=e["name"].replace(n,"")+":"+e["targetname"].replace(n,""):e["label"]=e["targetname"].replace(n,"")),delete e.children}));var a={};return e.forEach((function(e){a[e.targetid]=e})),e.forEach((function(e){var n=a[e.sourceid];n?(n.children||(n.children=[])).push(e):t.push(e)})),t},graphContainerClick:function(e){e.preventDefault()},getdomaingraph:function(){var e;return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:return e=this,e.loading=!0,{fileID:e.currentFile.id,domain:e.domain,nodename:e.domainnodename,pageSize:e.pagesize,hops:e.hops,Matchtype:1},t.next=5,regeneratorRuntime.awrap(e.$api.kgManager.getFailurePredictDomainGraph({failure_type:e.failure_type,tempalte_id:e.tempalte_id}).then((function(t){if(200===t.code){var n=t.data;null!=n&&(e.graph.nodes=n.node,e.graph.links=n.relationship,e.updategraph())}})).catch((function(t){e.$message.error("没有相关知识，请参考相关推荐")})));case 5:case"end":return t.stop()}}),null,this)},getsearchdomaingraph:function(){var e,t;return regeneratorRuntime.async((function(n){while(1)switch(n.prev=n.next){case 0:if(this.nodeinfo=null,""==this.nodename){n.next=12;break}return e=this.domainnodename,this.domainnodename=this.nodename,t=this.domain,this.domain="ALL",n.next=8,regeneratorRuntime.awrap(this.getdomaingraph());case 8:this.domain=t,this.domainnodename=e,n.next=14;break;case 12:return n.next=14,regeneratorRuntime.awrap(this.getdomaingraph());case 14:case"end":return n.stop()}}),null,this)},initgraph:function(){var e=s["j"](".graphcontainer"),t=s["j"](".main"),n=t._groups[0][0].offsetWidth,a=window.screen.height-160;this.svg=e.append("svg"),this.svg.attr("width",n),this.svg.attr("height",a),this.simulation=s["h"]().force("link",s["f"]().distance((function(e){return Math.floor(200*Math.random())+100})).id((function(e){return e.uuid}))).force("charge",s["g"]().strength(-400).distanceMax(400)).force("collide",s["e"](30).strength(.9).iterations(1)).force("center",s["d"](n/2,(a-200)/2)).alpha(1).alphaTarget(0).alphaDecay(.01),this.linktextGroup=this.svg.append("g").attr("class","linetext"),this.linkGroup=this.svg.append("g").attr("class","line"),this.nodeGroup=this.svg.append("g").attr("class","node"),this.nodetextGroup=this.svg.append("g").attr("class","nodetext"),this.nodesymbolGroup=this.svg.append("g").attr("class","nodesymbol"),this.nodebuttonGroup=this.svg.append("g").attr("class","nodebutton"),this.addmaker(),this.tooltip=this.svg.append("div").style("opacity",0),this.svg.on("click",(function(){s["k"](".buttongroup").classed("circle_opreate",!0)}),"false")},updategraph:function(){var e=this,t=e.graph.links,n=e.graph.nodes,a=[],i=(s["j"](".graphcontainer"),e.domainnodename,0);if(n.forEach((function(t){var n=e.similar(t.name,e.domainnodename,2);n>i&&(i=n,t.name)})),e.illustrations=[],n.forEach((function(t){t.fx=null,t.fy=null,"undefined"!=typeof t.fx&&""!==t.fx&&null!=t.fx||(t.fx=null),"undefined"!=typeof t.fy&&""!==t.fy&&null!=t.fy||(t.fy=null),"string"==typeof t.fx&&(t.fx=parseFloat(t.fx)),"string"==typeof t.fy&&(t.fy=parseFloat(t.fy)),-1==e.illustrations.indexOf(t.type)&&e.illustrations.push(t.type)})),t.forEach((function(e){var t=n.filter((function(t){return t.uuid===e.sourceid}))[0];if("undefined"!=typeof t){var i=n.filter((function(t){return t.uuid===e.targetid}))[0];"undefined"!=typeof i&&a.push({source:t.uuid,target:i.uuid,lk:e})}})),e.addnodebutton(),a.length>0){o.a.each(a,(function(e){var t=o.a.filter(a,{source:e.source,target:e.target}),n=o.a.filter(a,{source:e.target,target:e.source}),i=t.concat(n);o.a.each(i,(function(e,t){e.sameIndex=t+1,e.sameTotal=i.length,e.sameTotalHalf=e.sameTotal/2,e.sameUneven=e.sameTotal%2!==0,e.sameMiddleLink=!0===e.sameUneven&&Math.ceil(e.sameTotalHalf)===e.sameIndex,e.sameLowerHalf=e.sameIndex<=e.sameTotalHalf,e.sameArcDirection=1,e.sameIndexCorrected=e.sameLowerHalf?e.sameIndex:e.sameIndex-Math.ceil(e.sameTotalHalf)}))}));var r=o.a.chain(a).sortBy((function(e){return e.sameTotal})).last().value().sameTotal;o.a.each(a,(function(e){e.maxSameHalf=Math.round(r/2)}))}var d=e.linkGroup.selectAll(".line >path").data(a,(function(e){return e.uuid}));d.exit().remove();var c=e.drawlink(d);d=c.merge(d),e.linktextGroup.selectAll("text").data(a,(function(e){return e.uuid})).exit().remove();var u=e.linktextGroup.selectAll("text >textPath").data(a,(function(e){return e.uuid}));u.exit().remove();var l=e.drawlinktext(u);u=l.merge(u).text((function(e){return e.lk.name})),s["k"](".nodebutton >g").remove();var f=e.nodebuttonGroup.selectAll(".nodebutton").data(n,(function(e){return e}));f.exit().remove();var p=e.drawnodebutton(f);f=p.merge(f);var h=e.nodeGroup.selectAll("circle").data(n,(function(e){return e.uuid}));h.exit().remove();var g=e.drawnode(h);h=g.merge(h).text((function(e){return e.name}));var m=e.nodetextGroup.selectAll("text").data(n,(function(e){return e.uuid}));m.exit().remove();var v=e.drawnodetext(m);m=v.merge(m).text((function(e){if("undefined"==typeof e.name)return"";if(e.name.length>8){var t=e.name.slice(0,7)+"...";return t}return e.name})),m.append("title").text((function(e){return e.name}));var y=e.nodesymbolGroup.selectAll("path").data(n,(function(e){return e.uuid}));y.exit().remove();var k=e.drawnodesymbol(y);function x(e){var t=e.target.x-e.source.x,n=e.target.y-e.source.y,a=Math.sqrt(t*t+n*n),i=e.sameUneven?0:.5,r=2,o=1/r*(a*e.maxSameHalf/(e.sameIndexCorrected-i));e.sameMiddleLink&&(o=0);var s="M"+e.source.x+","+e.source.y+"A"+o+","+o+" 0 0,"+e.sameArcDirection+" "+e.target.x+","+e.target.y;return s}function b(){d.attr("d",x),h.attr("cx",(function(e){return e.x})).attr("cy",(function(e){return e.y})),f.attr("cx",(function(e){return e.x})).attr("cy",(function(e){return e.y})),f.attr("transform",(function(e){return"translate("+e.x+","+e.y+") scale(1)"})),m.attr("x",(function(e){return e.x})).attr("y",(function(e){return e.y})),y.attr("transform",(function(e){return"translate("+(e.x+8)+","+(e.y-30)+") scale(0.015,0.015)"}))}y=k.merge(y),y.attr("fill","#e15500"),y.attr("display",(function(e){return"undefined"!=typeof e.hasfile&&e.hasfile>0?"block":"none"})),e.simulation.nodes(n).on("tick",b),e.simulation.force("link").links(a),e.simulation.alpha(1).alphaTarget(0).alphaDecay(.01).restart();var w=s["l"]().on("zoom",(function(){s["k"](".node").attr("transform",s["n"](e.svg.node())),s["k"](".nodetext").attr("transform",s["n"](e.svg.node())),s["k"](".line").attr("transform",s["n"](e.svg.node())),s["k"](".linetext").attr("transform",s["n"](e.svg.node())),s["k"](".nodesymbol").attr("transform",s["n"](e.svg.node())),s["k"](".nodebutton").attr("transform",s["n"](e.svg.node()))}));e.svg.call(w),e.svg.call(w.transform,s["m"]),e.svg.call(s["l"]().on("zoom",(function(){s["j"]("#link_menubar").style("display","none"),s["j"]("#nodedetail").style("display","none"),s["k"](".node").attr("transform",s["c"].transform),s["k"](".nodetext").attr("transform",s["c"].transform),s["k"](".line").attr("transform",s["c"].transform),s["k"](".linetext").attr("transform",s["c"].transform),s["k"](".nodesymbol").attr("transform",s["c"].transform),s["k"](".nodebutton").attr("transform",s["c"].transform)}))),e.svg.on("dblclick.zoom",null),e.svg.selectAll(".buttongroup").on("click",(function(t,n){if(e.nodebuttonAction){switch(e.nodebuttonAction){case"EDIT":e.isedit=!0,e.propactiveName="propedit",e.txx=t.x,e.tyy=t.y;break;case"MORE":e.getmorenode(t);break;case"LINK":e.isaddlink=!0,e.selectsourcenodeid=t.uuid;break;case"DELETE":e.selectnodeid=t.uuid;var a=".out_buttongroup_"+n;e.deletenode(a);break}}})),e.svg.selectAll(".action_0").on("click",(function(t){e.nodebuttonAction="EDIT"})),e.svg.selectAll(".action_1").on("click",(function(t){e.nodebuttonAction="MORE"})),e.svg.selectAll(".action_2").on("click",(function(t){e.nodebuttonAction="LINK"})),e.svg.selectAll(".action_3").on("click",(function(t){e.nodebuttonAction="DELETE"}))},requestFullScreen:function(){var e=document.getElementById("graphcontainerdiv"),t=window.screen.width,n=window.screen.height;this.svg.attr("width",t),this.svg.attr("height",n),e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullScreen?e.webkitRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen()},saveproperties:function(){var e=this,t={fileID:e.currentFile.id,label:e.domain,id:e.graphEntity.uuid,properties:JSON.stringify(e.properties)};e.$api.kgManager.saveProperties(t).then((function(t){200===t.code?e.$message({message:"操作成功",type:"success"}):e.$message({message:t.msg,type:"error"})})).catch((function(t){e.$message.error("saveproperties: "+t)}))},createnode:function(){var e=this,t={domain:e.domain,fileID:e.currentFile.id,name:e.graphEntity.name};e.$api.kgManager.createNode(t).then((function(t){if(200===t.code){if(0!==e.graphEntity.uuid)for(var n=0;n<e.graph.nodes.length;n++)e.graph.nodes[n].uuid===e.graphEntity.uuid&&e.graph.nodes.splice(n,1);var a=t.data;a.x=e.txx,a.y=e.tyy,a.fx=e.txx,a.fy=e.tyy,e.graph.nodes.push(a),e.resetentity(),e.updategraph(),e.isedit=!1,e.resetsubmit()}})).catch((function(t){e.$message.error("createnode: "+t)}))},resetentity:function(){this.graphEntity={fileID:this.currentFile.id,uuid:0,color:"ff4500",name:"",r:40,x:"",y:""}},resetsubmit:function(){this.isaddnode=!1,this.isedit=!1,this.resetentity(),this.fieldDataList=[],this.dataconfigactive="",this.isbatchcreate=!1,this.selectnodeid=0},newProperty:function(){({})!==this.properties&&(this.properties[document.getElementById("newPropertyInput").value]="",this.propertyCreate=!1)},addnodebutton:function(e){s["k"]("svg >defs").remove();var t=this.graph.nodes,n=[1,1,1,1],a=s["i"](),i=a(n),r=this.svg.append("defs");t.forEach((function(e){var t=r.append("g").attr("id","out_circle"+e.uuid),n=t.selectAll(".buttongroup").data(i).enter().append("g").attr("class",(function(e,t){return"action_"+t})),a=30;"undefined"==typeof e.r&&(e.r=a);var o=s["a"]().innerRadius(e.r).outerRadius(e.r+30);n.append("path").attr("d",(function(e){return o(e)})).attr("fill","#D2D5DA").style("opacity",.6).attr("stroke","#f0f0f4").attr("stroke-width",2),n.append("text").attr("transform",(function(e,t){return"translate("+o.centroid(e)+")"})).attr("text-anchor","middle").text((function(e,t){var n=new Array;return n[0]="编辑",n[1]="展开",n[2]="连线",n[3]="删除",n[t]})).attr("font-size",10)}))},btnaddsingle:function(){s["j"](".graphcontainer").style("cursor","crosshair")},getProperties:function(e,t){var n=this,a={fileID:n.currentFile.id,label:e,id:t};n.$api.kgManager.getProperties(a).then((function(e){200===e.code&&(n.properties=e.data)})).catch((function(e){n.$message.error("getProperties: "+e)}))},getcurrentnodeinfo:function(e){var t=this,n={fileID:t.currentFile.id,domain:t.domain,nodeid:e.uuid};t.$api.kgManager.getRelationNodeCount(n).then((function(n){200===n.code&&(t.selectnode.name=e.name,t.selectnode.count=n.data)})).catch((function(e){t.$message.error("getcurrentnodeinfo: "+e)}))},getmorenode:function(e){var t=this,n={nodeid:t.selectnodeid};t.$api.kgManager.getMoreRelationNode(n).then((function(e){if(200===e.code){var n=e.data.node,a=e.data.relationship,i=t.graph.nodes.length,r=t.graph.links.length;n.forEach((function(e){var n=t.graph.nodes.find((function(t){return t.uuid===e.uuid}));"undefined"==typeof n&&t.graph.nodes.push(e)})),a.forEach((function(e){var n=t.graph.links.find((function(t){return t.uuid===e.uuid}));"undefined"==typeof n&&t.graph.links.push(e)}));var o=t.graph.links.length,s=t.graph.nodes.length;if(s<=i&&o<=r)return void t.$message({message:"没有更多信息",type:"success"});t.updategraph()}})).catch((function(e){t.$message.error("getmorenode: "+e)}))},createSingleNode:function(){var e=this,t={fileID:e.currentFile.id,name:""};"ALL"===e.domain||""===e.domain?e.$prompt("请输入节点类型","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:this.selectlinkname}).then((function(n){t.domain=n.value,e.$api.kgManager.createNode(t).then((function(t){if(200===t.code){s["j"](".graphcontainer").style("cursor","");var n=t.data;n.x=e.txx,n.y=e.tyy,n.fx=e.txx,n.fy=e.tyy,e.graph.nodes.push(n),e.updategraph()}})).catch((function(t){e.$message.error("createSingleNode: "+t)}))})).catch((function(t){e.$message.error(t)})):(t.domain=e.domain,e.$api.kgManager.createNode(t).then((function(t){if(200===t.code){s["j"](".graphcontainer").style("cursor","");var n=t.data;n.x=e.txx,n.y=e.tyy,n.fx=e.txx,n.fy=e.tyy,e.graph.nodes.push(n),e.updategraph()}})).catch((function(t){e.$message.error("createSingleNode: "+t)})))},deletenode:function(e){var t=this;t.$confirm("此操作将删除该节点及周边关系(不可恢复), 是否继续?","三思而后行",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var n={fileID:t.currentFile.id,domain:t.domain,nodeid:t.selectnodeid};t.$api.kgManager.deleteNode(n).then((function(n){if(200===n.code){t.svg.selectAll(e).remove();for(var a=n.data,i=0;i<a.length;i++)for(var r=0;r<t.graph.links.length;r++)t.graph.links[r].uuid===a[i].uuid&&(t.graph.links.splice(r,1),r-=1);var o=-1;for(r=0;r<t.graph.nodes.length;r++)if(t.graph.nodes[r].uuid===t.selectnodeid){o=r;break}o>=0&&(t.selectnodeid=0,t.graph.nodes.splice(r,1),t.updategraph(),t.resetentity(),t.$message({type:"success",message:"操作成功!"}))}})).catch((function(e){t.$message.error("deletenode: "+e)}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},deletelink:function(){var e=this;this.$confirm("此操作将删除该关系(不可恢复), 是否继续?","三思而后行",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t={fileID:e.currentFile.id,domain:e.domain,shipid:e.selectnodeid};e.$api.kgManager.deleteLink(t).then((function(t){if(200===t.code){for(var n=-1,a=0;a<e.graph.links.length;a++)if(e.graph.links[a].uuid===e.selectnodeid){n=a;break}n>=0&&(e.selectnodeid=0,e.graph.links.splice(a,1),e.updategraph(),e.isdeletelink=!1)}})).catch((function(t){e.$message.error("deletelink: "+t)}))})).catch((function(){this.$message({type:"info",message:"已取消删除"})}))},createlink:function(e,t,n){var a=this;a.$prompt("请输入关系类型","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:this.selectlinkname}).then((function(n){var i={fileID:a.currentFile.id,domain:n.value,sourceid:e,targetid:t,ship:""};a.$api.kgManager.createLink(i).then((function(e){if(200===e.code){var t=e.data;a.graph.links.push(t),a.updategraph(),a.isaddlink=!1}})).catch((function(e){a.$message.error("createlink: "+e)}))}))},updatelinkName:function(){var e=this;e.$prompt("请输入关系名称","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:this.selectlinkname}).then((function(t){value=t.value;var n={fileID:e.currentFile.id,domain:e.domain,shipid:e.selectnodeid,shipname:value};e.$api.kgManager.updateLink(n).then((function(t){if(200===t.code){var n=t.data;e.graph.links.forEach((function(e){e.uuid===n.uuid&&(e.name=n.name)})),e.selectnodeid=0,e.updategraph(),e.isaddlink=!1,e.selectlinkname=""}})).catch((function(t){e.$message.error("updatelink: "+t)}))})).catch((function(){e.$message({type:"info",message:"取消输入"})}))},updatenodename:function(e){var t=this;t.$alert(e.name,"节点名称",{confirmButtonText:"确定"})},addmaker:function(){var e=this.svg.append("marker").attr("id","arrow").attr("markerUnits","strokeWidth").attr("markerWidth","20").attr("markerHeight","20").attr("viewBox","0 -5 10 10").attr("refX","22").attr("refY","0").attr("orient","auto"),t="M0,-5L10,0L0,5";e.append("path").attr("d",t).attr("fill","#fce6d4")},drawnode:function(e){var t=this,n=e.enter().append("circle");return n.attr("r",(function(e){return"undefined"!=typeof e.r&&""!==e.r?e.r:40})),n.attr("fill",(function(e){return"undefined"!=typeof e.color&&""!==e.color?e.color:"undefined"!=typeof e.type&&t.nodeColorMap.has(e.type)?t.nodeColorMap.get(e.type):"#ff4500"})),n.style("opacity",.9),n.style("stroke",(function(e){return"undefined"!=typeof e.color&&""!==e.color?e.color:"#EDFDFF"})),n.style("stroke-opacity",.6),n.append("title").text((function(e){return e.name})),n.on("mouseover",(function(e,n){t.nodedetail=e})),n.on("dblclick",(function(e){t.updatenodename(e)})),n.on("mouseenter",(function(e){var t=s["j"](this)._groups[0][0];t.classList.contains("selected")||s["j"](this).style("stroke-width","6")})),n.on("mouseleave",(function(e){var t=s["j"](this)._groups[0][0];t.classList.contains("selected")||s["j"](this).style("stroke-width","2")})),n.on("click",(function(e,n){if(t.graphEntity=e,t.selectnodeid=e.uuid,t.selectnodename=e.name,t.isaddlink){if(t.selecttargetnodeid=e.uuid,t.selectsourcenodeid===t.selecttargetnodeid||0===t.selectsourcenodeid||0===t.selecttargetnodeid)return;t.createlink(t.selectsourcenodeid,t.selecttargetnodeid,"RE"),t.selectsourcenodeid=0,t.selecttargetnodeid=0,e.fixed=!1,s["c"].stopPropagation()}if(t.nodeinfo=new Map,e.name&&t.nodeinfo.set("名称",[{id:e.uuid,info:e.name}]),e.type&&t.nodeinfo.set("节点类型",[{id:e.uuid,info:e.type}]),t.graph.links.forEach((function(n){if(n.sourceid==e.uuid)if(t.nodeinfo.has(n.name)){var a=t.nodeinfo.get(n.name);a.push({id:n.targetid,info:n.targetname}),t.nodeinfo.set(n.name,a)}else{a=new Array({id:n.targetid,info:n.targetname});t.nodeinfo.set(n.name,a)}})),t.nodeinfo.has("原因")){var a=t.nodeinfo.get("原因"),i=[];a.forEach((function(e){i.push(e["id"])})),t.graph.links.forEach((function(e){var t=i.indexOf(e.sourceid);-1!=t&&(a[t]["info2"]=e.targetname)})),t.nodeinfo.set("原因",a)}})),n.call(s["b"]().on("start",t.dragstarted).on("drag",t.dragged).on("end",t.dragended)),n},drawnodetext:function(e){var t=e.enter().append("text").style("fill","#000").attr("dy",4).attr("font-family","微软雅黑").attr("text-anchor","middle").text((function(e){if("undefined"==typeof e.name)return"";if(e.name.length>8){var t=e.name.slice(0,7)+"...";return t}return e.name}));return t.style("pointer-events","none"),t},drawnodesymbol:function(e){var t=this,n="M566.92736 550.580907c30.907733-34.655573 25.862827-82.445653 25.862827-104.239787 0-108.086613-87.620267-195.805867-195.577173-195.805867-49.015467 0-93.310293 18.752853-127.68256 48.564907l-0.518827-0.484693-4.980053 4.97664c-1.744213 1.64864-3.91168 2.942293-5.59104 4.72064l0.515413 0.484693-134.69696 133.727573L216.439467 534.8352l0 0 137.478827-136.31488c11.605333-10.410667 26.514773-17.298773 43.165013-17.298773 36.051627 0 65.184427 29.197653 65.184427 65.24928 0 14.032213-5.33504 26.125653-12.73856 36.829867l-131.754667 132.594347 0.515413 0.518827c-10.31168 11.578027-17.07008 26.381653-17.07008 43.066027 0 36.082347 29.16352 65.245867 65.184427 65.245867 16.684373 0 31.460693-6.724267 43.035307-17.07008l0.515413 0.512M1010.336427 343.49056c0-180.25472-145.882453-326.331733-325.911893-326.331733-80.704853 0-153.77408 30.22848-210.418347 79.0528l0.484693 0.64512c-12.352853 11.834027-20.241067 28.388693-20.241067 46.916267 0 36.051627 29.16352 65.245867 65.211733 65.245867 15.909547 0 29.876907-6.36928 41.192107-15.844693l0.38912 0.259413c33.624747-28.030293 76.301653-45.58848 123.511467-45.58848 107.99104 0 195.549867 87.6544 195.549867 195.744427 0 59.815253-27.357867 112.71168-69.51936 148.503893l0 0-319.25248 317.928107 0 0c-35.826347 42.2912-88.654507 69.710507-148.340053 69.710507-107.956907 0-195.549867-87.68512-195.549867-195.805867 0-59.753813 27.385173-112.646827 69.515947-148.43904l-92.18048-92.310187c-65.69984 59.559253-107.700907 144.913067-107.700907 240.749227 0 180.28544 145.885867 326.301013 325.915307 326.301013 95.218347 0 180.02944-41.642667 239.581867-106.827093l0.13312 0.129707 321.061547-319.962453-0.126293-0.13312C968.69376 523.615573 1010.336427 438.71232 1010.336427 343.49056L1010.336427 343.49056 1010.336427 343.49056zM1010.336427 343.49056",a=e.enter().append("path").attr("d",n);return a.call(s["b"]().on("start",t.dragstarted).on("drag",t.dragged).on("end",t.dragended)),a},drawnodebutton:function(e){var t=e.enter().append("g").append("use").attr("r",(function(e){return e.r})).attr("xlink:href",(function(e){return"#out_circle"+e.uuid})).attr("class",(function(e,t){return"buttongroup out_buttongroup_"+t})).classed("circle_opreate",!0);return t},drawlink:function(e){var t=this,n=e.enter().append("path").attr("stroke-width",2).attr("stroke","#fce6d4").attr("fill","#DEB887").attr("id",(function(e){return"invis_"+e.lk.sourceid+"-"+e.lk.name+"-"+e.lk.targetid}));return n.on("dblclick",(function(e){t.selectnodeid=e.lk.uuid,t.isdeletelink?t.deletelink():t.updatelinkName()})),n.on("mouseenter",(function(e){s["j"](this).attr("stroke","#ff9e9e"),t.nodedetail=e.lk,s["j"]("#nodedetail").style("display","block")})),n.on("mouseleave",(function(e){s["j"](this).attr("stroke","#fce6d4")})),n},drawlinktext:function(e){var t=this,n=e.enter().append("text").style("fill","#e3af85").append("textPath").attr("startOffset","50%").attr("text-anchor","middle").attr("xlink:href",(function(e){return"#invis_"+e.lk.sourceid+"-"+e.lk.name+"-"+e.lk.targetid})).style("font-size",14).text((function(e){if(""!==e.lk.name)return e.lk.name}));return n.on("mouseover",(function(e){t.selectnodeid=e.lk.uuid,t.selectlinkname=e.lk.name})),n},dragstarted:function(e){this.simulation.alpha(1).alphaDecay(0).restart(),e.fx=e.x,e.fy=e.y,e.fixed=!0},dragged:function(e){e.fx=s["c"].x,e.fy=s["c"].y},dragended:function(e){this.simulation.alpha(1).alphaDecay(.05).restart()},firstPage:function(){this.pageNum=1},scaleD:function(){this.scale+=5,this.$refs.pdf.$el.style.width=parseInt(this.scale)+"%"},scaleX:function(){100!=this.scale&&(this.scale+=-5,this.$refs.pdf.$el.style.width=parseInt(this.scale)+"%")},prePage:function(){var e=this.pageNum;e=e>1?e-1:this.pageTotalNum,this.pageNum=e},nextPage:function(){var e=this.pageNum;e=e<this.pageTotalNum?e+1:1,this.pageNum=e},getNumPages:function(e){var t=this,n=pdf.createLoadingTask(e);n.then((function(e){t.pdfUrl=n,t.numPages=e.numPages})).catch((function(e){}))},similar:function(e,t,n){if(!e||!t)return 0;if(e===t)return 100;var a=e.length>t.length?e.length:t.length,i=e.length,r=t.length,o=[];n=n||2;var s,d,c,u,l,f=function(e,t,n){return e<t?e<n?e:n:t<n?t:n};if(0===i)return r;if(0===r)return i;for(s=0;s<=i;s++)o[s]=[],o[s][0]=s;for(d=0;d<=r;d++)o[0][d]=d;for(s=1;s<=i;s++)for(c=e.charAt(s-1),d=1;d<=r;d++)u=t.charAt(d-1),l=c===u?0:1,o[s][d]=f(o[s-1][d]+1,o[s][d-1]+1,o[s-1][d-1]+l);var p=100*(1-o[i][r]/a);return p.toFixed(n)}}},u=c,l=(n("478a"),n("2877")),f=Object(l["a"])(u,a,i,!1,null,"f279fb88",null);t["default"]=f.exports},aeb0:function(e,t,n){var a=n("9bf2").f;e.exports=function(e,t,n){n in e||a(e,n,{configurable:!0,get:function(){return t[n]},set:function(e){t[n]=e}})}},b2cc:function(e,t,n){},eed2:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("9f12"),i=n("53fe"),r=n("8f4d"),o=function(){function e(){Object(a["a"])(this,e)}return Object(i["a"])(e,[{key:"predict",value:function(e){return Object(r["a"])({url:"/sensordata/deviceSensor/predict",method:"get",params:{deviceId:e}})}},{key:"type",value:function(e){return Object(r["a"])({url:"/sensordata/deviceSensor/type",method:"get",params:{deviceId:e}})}}]),e}()}}]);