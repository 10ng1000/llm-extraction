(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-31c84782"],{"87bb":function(e,t,a){"use strict";a("99af");var r=a("8f4d");t["a"]={executeSql:function(e,t){return Object(r["a"])({url:"/database/table/executeSql/".concat(e,"?dataSourceId=").concat(t),method:"get"})},save:function(e){return Object(r["a"])({url:"/gen/genTable/saveTableFromDB",method:"post",data:e})},queryAlter:function(e,t){return Object(r["a"])({url:"/database/table/alter",method:"get",params:{dataSourceId:e,name:t}})},submitAlter:function(e){return Object(r["a"])({url:"/database/table/alter/do",method:"post",data:e})},queryCreate:function(e){return Object(r["a"])({url:"/database/table/create",method:"get",params:{dataSourceId:e}})},submitCreate:function(e){return Object(r["a"])({url:"/database/table/create/do",method:"post",data:e})},list:function(e){return Object(r["a"])({url:"/database/table/list",method:"get",params:e})},drop:function(e,t){return Object(r["a"])({url:"/database/table/drop",method:"delete",params:{tableName:e,dataSourceId:t}})}}},"9c4f":function(e,t,a){"use strict";var r=a("8f4d");t["a"]={save:function(e){return Object(r["a"])({url:"/database/datalink/dataSource/save",method:"post",data:e})},test:function(e){return Object(r["a"])({url:"/database/datalink/dataSource/test",method:"post",data:e})},checkEnName:function(e,t){return Object(r["a"])({url:"/database/datalink/dataSource/checkEnName",method:"get",params:{oldEnName:e,enName:t}})},delete:function(e){return Object(r["a"])({url:"/database/datalink/dataSource/delete",method:"delete",params:{ids:e}})},queryById:function(e){return Object(r["a"])({url:"/database/datalink/dataSource/queryById",method:"get",params:{id:e}})},list:function(e){return Object(r["a"])({url:"/database/datalink/dataSource/list",method:"get",params:e})},treeData:function(){return Object(r["a"])({url:"/database/datalink/dataSource/treeData",method:"get"})}}},f395:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"jp-common-layout page"},[a("div",{staticClass:"jp-common-layout-left"},[a("div",{staticClass:"jp-common-title"},[a("el-input",{attrs:{placeholder:"数据库:请输入关键字过滤",size:"small",clearable:""},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}})],1),a("div",{staticClass:"jp-common-el-tree-scrollbar el-scrollbar"},[a("div",{staticClass:"el-scrollbar__wrap"},[a("div",{staticClass:"el-scrollbar__view"},[a("el-tree",{ref:"databaseTree",staticClass:"filter-tree",attrs:{data:e.databaseTreeData,props:{value:"id",label:"label",children:"children"},"default-expand-all":"","filter-node-method":e.filterNode,"expand-on-click-node":!1,"node-key":"id","highlight-current":""},on:{"node-click":e.handleNodeClick}})],1)])])]),a("div",{staticClass:"jp-common-layout-center jp-flex-main"},[a("el-form",{ref:"searchForm",staticClass:"query-form",attrs:{size:"small",inline:!0,model:e.searchForm},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.refreshList()},submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{prop:"name"}},[a("el-input",{attrs:{size:"small",placeholder:"表名",clearable:""},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:function(t){return e.refreshList()}}},[e._v("查询")]),a("el-button",{attrs:{size:"small",icon:"el-icon-refresh-right"},on:{click:function(t){return e.resetSearch()}}},[e._v("重置")])],1)],1),a("div",{staticClass:"bg-white top"},[a("vxe-toolbar",{attrs:{refresh:{query:e.refreshList}},scopedSlots:e._u([{key:"buttons",fn:function(){return[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:function(t){return e.add()}}},[e._v("创建表")])]},proxy:!0}])}),a("div",{staticStyle:{height:"calc(100% - 20px)"}},[a("vxe-table",{ref:"dataSourceTable",attrs:{border:"inner","auto-resize":"",resizable:"",height:"auto",loading:e.loading,size:"small","show-header-overflow":"","show-overflow":"","highlight-hover-row":"","menu-config":{},"print-config":{},"import-config":{},"export-config":{},data:e.dataList,"checkbox-config":{}}},[a("vxe-column",{attrs:{type:"selection","header-align":"center",align:"center",width:"50"}}),e._v("> "),a("vxe-column",{attrs:{field:"name",sortable:"",title:"表名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(a){return e.view(t.row)}}},[e._v(e._s(t.row.name))])]}}])}),a("vxe-column",{attrs:{field:"schema",sortable:"",title:"模式"}}),a("vxe-column",{attrs:{field:"catalog",sortable:"",title:"数据库"}}),a("vxe-column",{attrs:{field:"description",sortable:"",title:"说明"}}),a("vxe-column",{attrs:{align:"center",width:"250px",title:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{icon:"el-icon-edit",type:"text",size:"small"},on:{click:function(a){return e.edit(t.row)}}},[e._v("编辑表")]),a("el-button",{attrs:{icon:"el-icon-delete",type:"text",size:"small"},on:{click:function(a){return e.drop(t.row)}}},[e._v("删除表")]),a("el-button",{attrs:{icon:"el-icon-view",type:"text",size:"small"},on:{click:function(a){return e.view(t.row)}}},[e._v("查看数据")])]}}])})],1),a("el-alert",{attrs:{title:"总共"+e.dataList.length+"条记录",type:"success",closable:!1}})],1)],1)],1),e.viewDataVisible?a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"查看数据",width:"80%",visible:e.viewDataVisible},on:{"update:visible":function(t){e.viewDataVisible=t}}},[a("el-table",{attrs:{size:"small",data:e.viewData.dataList}},e._l(e.viewData.columnList,(function(e){return a("el-table-column",{key:e.name,attrs:{"show-overflow-tooltip":"",property:e.name,label:e.description||e.name}})})),1)],1):e._e()],1)},i=[],n=(a("4de4"),a("c975"),a("d81d"),a("b0c0"),a("9c4f")),o=a("87bb"),s={data:function(){return{searchForm:{name:"",dataSourceId:""},filterText:"",viewDataVisible:!1,dataList:[],databaseTreeData:[],loading:!1,dataSourceId:"",viewData:{columnList:[],dataList:[]}}},watch:{filterText:function(e){this.$refs.databaseTree.filter(e)}},activated:function(){var e=this;this.refreshTree(),""!==this.searchForm.dataSourceId&&(this.refreshList(),this.$nextTick((function(){e.$refs.databaseTree.setCurrentKey(e.searchForm.dataSourceId)})))},methods:{add:function(){this.$router.push({path:"/database/datatable/TableForm",query:{dataSourceId:this.searchForm.dataSourceId,method:"add",title:"创建表"}})},edit:function(e){e=e||this.$refs.dataSetTable.getCheckboxRecords().map((function(e){return e}))[0],this.$router.push({path:"/database/datatable/TableForm",query:{name:e.name,dataSourceId:this.searchForm.dataSourceId,method:"edit",title:"编辑表"}})},drop:function(e){var t=this;this.$confirm("确定删除表吗?删除之后不可恢复！","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0,o["a"].drop(e.name,t.dataSourceId).then((function(e){var a=e.data;t.$message.success({dangerouslyUseHTMLString:!0,message:a}),t.refreshList(),t.loading=!1}))})).catch((function(){t.loading=!1}))},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},refreshList:function(){var e=this;this.searchForm.dataSourceId?(this.loading=!0,o["a"].list(this.searchForm).then((function(t){var a=t.data,r=a.rows.filter((function(t){if(t.name.indexOf(e.searchForm.name)>=0)return t}));e.dataList=r,e.loading=!1})).catch((function(t){t.data;e.dataList=[],e.loading=!1}))):this.$message.warning("请选择一个数据库!")},refreshTree:function(){var e=this;n["a"].treeData().then((function(t){var a=t.data;e.databaseTreeData=a}))},handleNodeClick:function(e){"db"===e.type&&(this.searchForm.dataSourceId=e.id,this.dataSourceId=e.id,this.refreshList())},handleNodeClose:function(){this.searchForm.dataSourceId="",this.dataSourceId="",this.dataList=[]},resetSearch:function(){this.$refs.searchForm.resetFields(),this.refreshList()},view:function(e){var t=this;this.viewDataVisible=!0,o["a"].executeSql(e.name,this.dataSourceId).then((function(e){var a=e.data;t.viewData.columnList=a.columns,t.viewData.dataList=a.list}))}}},l=s,c=a("2877"),d=Object(c["a"])(l,r,i,!1,null,null,null);t["default"]=d.exports}}]);