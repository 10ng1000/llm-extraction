(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4da99ce2"],{"185f":function(s,t,e){},"3e8f":function(s,t){},a425:function(s,t,e){"use strict";e.r(t);var a=function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticClass:"QAbackground"},[e("div",{staticClass:"QAbox"},[e("div",{staticClass:"chat"},[e("div",{staticClass:"chat-message-body",attrs:{id:"chatform"},on:{scroll:s.scroll}},[s.loading?e("Spin",[e("Icon",{staticClass:"spin-icon-load",attrs:{type:"ios-loading",size:"18"}})],1):s._e(),s._l(s.data,(function(t,a){return e("div",{key:a,staticClass:"message-card",attrs:{"dis-hover":""}},[e("div",{class:1==t.isOneself?"message-row-right":"message-row-left"},[e("img",{attrs:{src:t.avatar?t.avatar:s.defualtAvatar,height:"35",width:"35"}}),e("div",{staticClass:"message-content"},[e("div",{style:1==t.isOneself?"text-align:right;display: flex;flex-direction:row-reverse":""},[s._v(" "+s._s(t.nickName)+" "),e("span",{staticClass:"message-time"},[s._v(s._s(t.createTime))])]),e("div",{staticClass:"message-body",style:1==t.isOneself?"float: right;":"",on:{click:function(e){return s.popDiv(t)}}},[s._v(" "+s._s(t.content.msg)+" ")]),0==t.isOneself?e("div",[t.msgId==s.id-1?e("div",[3==s.response_arr[s.id].ansnum?e("div",[e("div",{staticClass:"user-choose",on:{click:function(t){return s.click_popcard(s.response_arr[s.id].ans1,s.response_arr[s.id].question1)}}},[s._v(" "+s._s(s.response_arr[s.id].question1)+" ")]),e("div",{staticClass:"user-choose",on:{click:function(t){return s.click_popcard(s.response_arr[s.id].ans2,s.response_arr[s.id].question2)}}},[s._v(" "+s._s(s.response_arr[s.id].question2)+" ")]),e("div",{staticClass:"user-choose",on:{click:function(t){return s.click_popcard(s.response_arr[s.id].ans3,s.response_arr[s.id].question3)}}},[s._v(" "+s._s(s.response_arr[s.id].question3)+" ")])]):s._e(),1==s.select_card_arr[s.id]?e("div",[e("div",{staticClass:"user-choose"},[s._v(" "+s._s(s.select_card)+" ")]),1==s.user_choose_check_if?e("i",{staticClass:"el-icon-check user-choose-icon",on:{click:function(t){return s.user_choose_check()}}}):s._e(),1==s.user_choose_close_if?e("i",{staticClass:"el-icon-close user-choose-icon",on:{click:function(t){return s.user_choose_close()}}}):s._e()]):s._e()]):s._e()]):s._e()])])])}))],2),e("div",{staticClass:"inputBox"},[e("div",{staticClass:"tools"},[e("el-tooltip",{staticClass:"tips",attrs:{effect:"dark",content:"请输入具体问题或尽可能多的关键词进行搜索。",placement:"top-start"}},[e("el-button",{attrs:{icon:"el-icon-question"}},[e("i",[s._v("提示")])])],1),e("el-select",{staticClass:"oldMessageSelect",attrs:{placeholder:"历史记录"}},s._l(s.pastMsg,(function(t){return e("el-option",{key:t,attrs:{value:t}},[e("span",{staticStyle:{float:"left"},on:{click:function(e){return s.selectPMsg(t)}}},[s._v(s._s(t))])])})),1)],1),e("textarea",{directives:[{name:"model",rawName:"v-model",value:s.form.msg,expression:"form.msg"}],staticClass:"inputArea",staticStyle:{margin:"10px 0"},attrs:{rows:4},domProps:{value:s.form.msg},on:{keydown:function(t){return s.handleKeyCode(t)},input:function(t){t.target.composing||s.$set(s.form,"msg",t.target.value)}}}),e("div",{staticClass:"footer-btn"},[e("div",{staticClass:"button-float"},[e("Button",{attrs:{type:"primary"},on:{click:s.sendMsg}},[s._v("发送")])],1)])])])]),e("div",{attrs:{id:"popBackground"},on:{click:function(t){return s.closePop()}}},[e("div",{attrs:{id:"popDiv"}},[e("p",[s._v(s._s(s.popMsg))])])])])},i=[],o=(e("4160"),e("caad"),e("c975"),e("0d03"),e("2532"),e("159b"),e("bc3a")),n=e.n(o),c=(e("3e8f"),{name:"chat",props:{value:{type:Boolean,default:!1}},data:function(){return{chatVisible:this.value,loading:!1,data:[{isOneself:!1,content:{msg:"欢迎使用智能问答功能。"},createTime:this.getCurDate(),nickName:"AI",msgId:0}],defualtAvatar:"/static/img/user.png",distincData:[],offsetMax:0,offsetMin:0,searchForm:{pageNumber:1,pageSize:20},form:{content:"",msg:""},popMsg:"",pastMsg:[],id:0,timerSwitch:0,response_arr:[{}],select_card_arr:[0],select_card:"",user_choose_check_if:1,user_choose_close_if:1}},methods:{init:function(){},loadMsg:function(){var s=this;this.searchForm.offsetMax=this.offsetMax,s.data.forEach((function(t){t.msgId=s.id,s.offsetMax<t.msgId&&(s.offsetMax=t.msgId),t.content=JSON.parse(t.content),s.data.unshift(t),s.distincData.push(t.msgId),s.offsetMin=t.msgId,s.id=s.id+1,s.response_arr.push({}),s.select_card_arr.push(0)})),this.scrollToBottom()},show:function(){this.data=[],this.distincData=[],this.offsetMax=0,this.offsetMin=0,this.searchForm.pageNumber=1,this.searchForm.pageSize=20,this.form={content:"",msg:""},this.loadMsg(),this.chatVisible=!0,this.timerSwitch=1,this.reloadData()},handleKeyCode:function(s){13==s.keyCode&&(s.metaKey?this.form.msg=this.form.msg+"\n":(s.preventDefault(),this.sendMsg()))},sendMsg:function(){var s=this,t=this;if(this.form.msg){var e={isOneself:!0,content:{msg:this.form.msg},createTime:this.getCurDate(),nickName:"User",msgId:this.id};this.id=this.id+1,t.response_arr.push({}),t.select_card_arr.push(0),this.data.push(e),this.pastMsg.includes(this.form.msg)||this.pastMsg.push(this.form.msg),this.distincData.push(e.msgId);var a={type:"txt",msg:this.form.msg};this.form.content=JSON.stringify(a),n.a.get("http://82.157.118.175:8093/wenda?keys="+this.form.msg).then((function(e){if(1==e.data.ansnum){var a={isOneself:!1,content:{msg:e.data.ans},createTime:s.getCurDate(),nickName:"AI",msgId:t.id};e.data.msgId=t.id,console.log(t.id),console.log(t.data),t.response_arr.push(e.data),t.select_card_arr.push(0),t.id=s.id+1,t.data.push(a),t.distincData.push(a.msgId),t.scrollToBottom()}if(3==e.data.ansnum){a={isOneself:!1,content:{msg:e.data.question},createTime:s.getCurDate(),nickName:"AI",msgId:t.id};e.data.msgId=t.id,console.log(t.id),console.log(t.data),t.response_arr.push(e.data),t.select_card_arr.push(0),t.id=s.id+1,t.data.push(a),t.distincData.push(a.msgId),t.scrollToBottom()}})),t.form.msg=""}else this.$Message.warning("不能发送空白信息")},scrollToBottom:function(){this.$nextTick((function(){var s=document.getElementById("chatform");s.scrollTop=s.scrollHeight}))},scroll:function(){var s=this,t=document.getElementById("chatform"),e=t.scrollTop;if(0==e){this.loading=!0;var a=this;this.searchForm.offsetMin=this.offsetMin,this.searchForm.offsetMax="",listMsgByOrder(this.searchForm).then((function(t){s.loading=!1,200==t.code&&t.data.forEach((function(s){a.distincData.indexOf(s.msgId)<0&&(s.content=JSON.parse(s.content),a.data.unshift(s),a.distincData.push(s.msgId),a.offsetMin>s.msgId&&(a.offsetMin=s.msgId))}))}))}},reloadData:function(){var s=this;this.timerSwitch&&setTimeout((function(){var t={pageNumber:1,pageSize:20};t.offsetMax=s.offsetMax;var e=s;listMsgByOrder(t).then((function(t){200==t.code&&(t.data.forEach((function(t){if(e.offsetMax<t.msgId&&(e.offsetMax=t.msgId),e.distincData.indexOf(t.msgId)<0){t.content=JSON.parse(t.content),e.data.push(t),e.distincData.push(t.msgId);var a=document.getElementById("chatform"),i=a.scrollHeight-a.scrollTop;i>0&&i<400&&s.scrollToBottom()}})),e.reloadData())}))}),2e3)},selectPMsg:function(s){this.form.msg=s},showMsg:function(s){1!=s.isOneself&&alert(s.content.msg)},popDiv:function(s){if(!(s.content.msg.length<300)){var t=document.getElementById("popBackground"),e=document.getElementById("popDiv");this.popMsg=s.content.msg,t.style.display="block",e.style.display="block"}},closePop:function(){var s=document.getElementById("popBackground"),t=document.getElementById("popDiv");s.style.display="none",t.style.display="none"},getCurDate:function(){var s=new Date,t=s.getFullYear(),e=s.getMonth()+1,a=s.getDate(),i=s.getHours(),o=s.getMinutes(),n=s.getSeconds(),c=t+"-"+e+"-"+a+" "+i+":"+o+":"+n;return c},click_popcard:function(s,t){var e=this;e.select_card="请问是否解决了您的问题？";var a={isOneself:!0,content:{msg:t},createTime:this.getCurDate(),nickName:"User",msgId:e.id};e.response_arr.push({}),e.select_card_arr.push(0),e.id=this.id+1,e.data.push(a),e.distincData.push(a.msgId);var i={isOneself:!1,content:{msg:s},createTime:this.getCurDate(),nickName:"AI",msgId:e.id};e.response_arr.push({}),e.select_card_arr.push(1),e.id=this.id+1,e.data.push(i),e.distincData.push(i.msgId),e.user_choose_check_if=1,e.user_choose_close_if=1,this.scrollToBottom()},user_choose_check:function(){var s=this;s.select_card="好的，感谢您的使用",s.user_choose_check_if=0,s.user_choose_close_if=0},user_choose_close:function(){var s=this;s.select_card="将返回上一级，您可以重新选择，或者换个说法",s.user_choose_check_if=0,s.user_choose_close_if=0,console.log(s.id),console.log(s.response_arr),s.select_card="请问是否解决了您的问题？";var t=s.data[s.id-3].content.msg,e=s.data[s.id-2].content.msg,a=s.response_arr[s.id-2],i={isOneself:!0,content:{msg:t},createTime:this.getCurDate(),nickName:"User",msgId:s.id};s.response_arr.push({}),s.select_card_arr.push(0),s.id=this.id+1,s.data.push(i),s.distincData.push(i.msgId);var o={isOneself:!1,content:{msg:e},createTime:this.getCurDate(),nickName:"AI",msgId:s.id};s.response_arr.push(a),s.select_card_arr.push(0),s.id=this.id+1,s.data.push(o),s.distincData.push(o.msgId),s.user_choose_check_if=1,s.user_choose_close_if=1,this.scrollToBottom()}},mounted:function(){}}),r=c,d=(e("b5a3"),e("2877")),l=Object(d["a"])(r,a,i,!1,null,"0b4bc2b4",null);t["default"]=l.exports},b5a3:function(s,t,e){"use strict";var a=e("185f"),i=e.n(a);i.a}}]);